<!--开票通知 -->
<style type="text/css">
	td{
		text-align:center; vertical-align:middle !important; 
	}
	
</style>
<div class="container-fluid">
	<div class="col-sm-12 plr0 height100 gridBox" id="tongzhi_gridBox">
		<table id="tongzhi_jqGrid"></table>
		<div id="tongzhi_jqGridPager"></div>
	</div>
</div>
<!-- 新增弹窗 -->
<div id="tongzhi_formBox" class="layerFormBox">
	<form class="form-horizontal layerForm col-xs-12">
		<h4 class="col-xs-12 text-center">中华人民共和国海关出口报关单</h4>
		<div class="col-xs-12 index">
			<div class="form-group col-xs-6 head">
				<label for="inputEmail3" class="col-xs-3 control-label">
					<span class="necessary">*</span>预录入编号:
				</label>
				<div class="col-xs-8">
					<input type="text" id="yulu_number" name="number" class="form-control input-sm"  placeholder="预录入编号">
				</div>
			</div>
			<div class="form-group col-xs-6 head">
				<label class="col-xs-3 control-label">
					海关编号:
				</label>
				<div class="col-xs-8">
					<input type="text" class="form-control input-sm"  placeholder="海关编号">
				</div>
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					<span class="necessary">*</span>出口口岸
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_type" name="type" class="form-control input-sm"  placeholder="出口口岸">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					备案号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="备案号">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					出口日期
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_outTime" name="outTime" class="form-control input-sm"  placeholder="出口日期">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					申报日期
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_county" name="createTime" class="form-control input-sm"  placeholder="申报日期">
				</div>		
			</div>

			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					<span class="necessary">*</span>经营单位
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="经营单位">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					运输方式
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="运输方式">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					运输工具
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="运输工具">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					提运单号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="提运单号">
				</div>		
			</div>

			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					<span class="necessary">*</span>发货单位
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="发货单位">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					贸易方式
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_property" name="property" class="form-control input-sm"  placeholder="运输方式">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					征免性质
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="征免性质">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					提运单号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="提运单号">
				</div>		
			</div>

			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					许可证号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="许可证号">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-6 control-label">
					抵运国（地区）
				</label>
				<div class="col-xs-6">
					<input type="text" id="yulu_company" name="company" class="form-control input-sm"  placeholder="抵运国（地区）">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					指运港
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_anothertype" name="anothertype" class="form-control input-sm"  placeholder="指运港">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					境内货源地
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="境内货源地">
				</div>		
			</div>

			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					批准文号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="批准文号">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					成交方式
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_pay" name="pay" class="form-control input-sm"  placeholder="成交方式">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					运费
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="运费">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					保费
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="保费">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					杂费
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="杂费">
				</div>		
			</div>

			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					合同协议号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="合同协议号">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					件数
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="件数">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-6 control-label">
					包装种类
				</label>
				<div class="col-xs-6">
					<input type="text" class="form-control input-sm"  placeholder="包装种类">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					毛重（kg）
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="毛重（kg）">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					净重（kg）
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="净重（kg）">
				</div>		
			</div>

			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					集装箱号
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="集装箱号">
				</div>		
			</div>
			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					随附单据
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_accessory" name="accessory" class="form-control input-sm"  placeholder="随附单据">
				</div>		
			</div>
			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					生产厂家
				</label>
				<div class="col-xs-7">
					<input type="text" class="form-control input-sm"  placeholder="随附单据">
				</div>		
			</div>

			<div class="form-group col-xs-12">
				<label class="col-xs-2 control-label text-center">
					标记码及备注
				</label>
				<div class="col-xs-10">
					<textarea type="text" class="form-control input-sm"  placeholder="标记码及备注"></textarea>.
				</div>		
			</div>
			<div id="yulu_ul col-xs-12">
				<table class="table col-xs-12">
					<thead class="thead">
						<tr>
							<th>项号</th>
							<th>商品编号</th>
							<th>商品名称 规格型号</th>
							<th>数量及单位</th>
							<th>最终目的国（地区）</th>
							<th>单价</th>
							<th>总价</th>
							<th>币值</th>
							<th>征免</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>2015</td>
							<td>汽车零件合同</td>
							<td>23540</td>
							<td>人民币</td>
							<td>2017-07-08</td>
							<td>已结清</td>
							<td>人民币</td>
							<td>2017-07-08</td>
							<td>已结清</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div class="form-group col-xs-12">
				<label class="col-xs-2 control-label text-center">
					税费征收情况
				</label>
				<div class="col-xs-10">
					<textarea type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="税费征收情况"></textarea>.
				</div>		
			</div>

			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					录入员
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="录入员">
				</div>		
			</div>
			<div class="form-group col-xs-4 text-center">
				<label class="control-label">
					兹上证明无讹并承担法律责任
				</label>		
			</div>
			<div class="form-group col-xs-4 text-center">
				<label class="control-label">
					海关审单批注及放行日期（签章）
				</label>		
			</div>

			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					报关员
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="报关员">
				</div>		
			</div>
			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					申报单位（签章）
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="申报单位（签章）">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					审单
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="审单">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					审价
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="审价">
				</div>		
			</div>

			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					单位地址
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="单位地址">
				</div>		
			</div>
			<div class="form-group col-xs-4">
				<label class="col-xs-5 control-label">
					申报单位（签章）
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="申报单位（签章）">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					征税
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="征税">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					统计
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="统计">
				</div>		
			</div>

			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					邮编
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="邮编">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					电话
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="电话">
				</div>		
			</div>
			<div class="form-group col-xs-3">
				<label class="col-xs-5 control-label">
					填制日期
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="填制日期">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					查验
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="查验">
				</div>		
			</div>
			<div class="form-group col-xs-2">
				<label class="col-xs-5 control-label">
					放行
				</label>
				<div class="col-xs-7">
					<input type="text" id="yulu_createTime" name="createTime" class="form-control input-sm"  placeholder="放行">
				</div>		
			</div>

		</div>
		<p class="text-center col-xs-12">
			<button type="butto-n" class="saveBtn btn btn-info btn-sm" id="tongzhi_save_btn">
				打印
			</button>
		</p>
	</form>
</div>
<!-- 新增弹窗 -->
<div id="guandan_jqGrid_formBox" class="layerFormBox">
	<form class="form-horizontal layerForm">
		<div class="form-group col-xs-6">
			<label for="inputEmail3" class="col-xs-3 control-label">
				关单号:
			</label>
			<div class="col-xs-8">
				<input type="text" id="role_relName" name="relName" class="form-control input-sm"  placeholder="关单号">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				供货商:
			</label>
			<div class="col-xs-8">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="供货商">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				征税率:
			</label>
			<div class="col-xs-8">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="征税率">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				退税率:
			</label>
			<div class="col-xs-8">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="退税率">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				开票品名:
			</label>
			<div class="col-xs-8 col-xs-6">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="开票品名">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				数量:
			</label>
			<div class="col-xs-8 col-xs-6">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="数量">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				单位:
			</label>
			<div class="col-xs-8">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="单位">
			</div>
		</div>
		<div class="form-group col-xs-6">
			<label class="col-xs-3 control-label">
				金额:
			</label>
			<div class="col-xs-8">
				<input type="text" id="role_name" name="name" class="form-control input-sm"  placeholder="金额">
			</div>
		</div>
		<p class="text-center">
			<button type="button" class="saveBtn btn btn-info btn-sm" id="role_save_btn">
				保存
			</button>
			<button type="reset" class="saveBtn btn btn-info btn-sm">
				重置
			</button>
			<button type="button" class="saveBtn btn btn-info btn-sm qx" id="role_cacle_btn">
				取消
			</button>
		</p>
	</form>
</div>
<script type="text/javascript">

	
$(function(){
	var dataUrl = 'data/tongzhi.json';
	var index = null;
	var flag = '';
	var rowNumber = 1000000;

	//表格数据
	var gridWidth = $('#tongzhi_gridBox').width();
	var gridHeight = $('#tongzhi_gridBox').height()-122;
	$("#tongzhi_jqGrid").jqGrid({
		
		hidegrid : false, 
		altRows : true, 
		colModel: [{label : '关单号', name : 'number', align: 'center', width: 100, formatter: formatName},
			{label : '通知单号', name : 'numbers', align: 'center', width: 100},
			{label : '供应商', name : 'company', align: 'center', width:80},
			{label : '征税率 ', name : 'Tarate', align: 'center', width:80,search:false},
			{label : '退税率', name : 'RefundRate', align: 'center', width:80,search:false},
			{label : '开票品名', name : 'name', align: 'center', width:80,search:false},
			{label : '数量', name : 'quantity', align: 'center', width: 80,search:false},
			{label : '单位', name : 'unit', align: 'center', width:80,search:false},
			{label : '金额', name : 'money', align: 'center', width:80,search:false},
			{label : '任务号', name : 'tongzhi', align: 'center', width: 100}
			// {label : '纸质发票个数', name : 'anotherNumber', align: 'center', width:60},
			// {label : '报关单号', name : 'numbers', align: 'center', width:120, cellattr: function(rowId, tv, rawObject, cm, rdata) {
   //                  return 'id=\'numbers' + rowId + "\'";
   //              }}
			],

		viewrecords: true,
		loadonce:true,
		width: gridWidth,
		//width: 'auto',
		//width : '100%',
		height: gridHeight,
		//height : 'auto',
		rowNum: 12,
		rowList:[10,15,20,25],
		datatype: 'local',
		pager: "#tongzhi_jqGridPager",
		multiselect: true,
		rownumbers: true,
		rownumWidth: 30,
		recordtext: "当前显示: <b>{0}</b>至<b>{1}</b> 总数: <b>{2}</b>",
	    //emptyrecords: "No records to view",
		//loadtext: "Loading...",
                    //调用合并方法
		// gridComplete: function() {
  //           var gridName = "tongzhi_jqGrid";
  //           Merger(gridName, 'numbers');
  //       }
	}).navGrid('#tongzhi_jqGridPager',{ 
	// the buttons to appear on the toolbar of the grid
		edit:false,add:false,del:false,search:false,refresh:false
	}).navButtonAdd('#tongzhi_jqGridPager',{
			//caption: '导出',
		caption: '',
		title : '导出',
		buttonicon : 'fa fa-download',
		onClickButton : tongzhi_importLayer, //调用导出函数
		position : 'last'
	}).navButtonAdd('#tongzhi_jqGridPager',{
				//caption: '新增',
			caption: '',
			title : '打印',
			buttonicon : 'fa fa-print',
			onClickButton : tongzhi_addLayer, //调用添加的函数
			position : 'last'
	}).navSeparatorAdd("#tongzhi_jqGridPager",{
			sepcontent: '',
			sepclass : "ui-separator"
	});

	//搜索框按钮,开启搜索框需要重新调整高度
	$('#tongzhi_jqGrid').jqGrid('filterToolbar');
	// 导出函数
	function tongzhi_importLayer(){
		var rowd = getSelectedRow();
		var len = rowd.length;
		if(rowd && $.isArray(rowd) && rowd.length>0){
			//删除
			var deletindex = layer.confirm('确定要导出吗？', {
			  btn: ['确定','取消'] //按钮
			}, function(){
				/*for(var i=0; i<len; i++){
					jQuery("#yulu_jqGrid").delRowData(rowd[0]);  
				}*/
			    layer.msg('导出成功', {icon: 1});
			}, function(){
			  	layer.close(deletindex);
			});
			
		}else{
			layer.msg('请选择记录!');
		}
	}

	$('.qx').on('click',function(){
		layer.close(layerIndex);
	});
	$('#tongzhi_save_btn').on('click',function(){
		layer.msg('打印成功!',{time:layerCloseTime});
	});
	//弹框保存按钮
	$(document).on('click','#role_save_btn',function(){
		if(flag == 'add'){
			var data = getFormData('guandan_jqGrid_formBox');
			var currentNumber = uuid.v4();
			var result = jQuery('#tongzhi_jqGrid').addRowData(currentNumber,data,'first');
			if(result){
				layer.msg('添加成功',{time:layerCloseTime});
				layer.close(layerIndex);
				
				jQuery('#tongzhi_jqGrid').setSelection(currentNumber,true);
				
			}else{
				layer.msg('添加失败!',{time:layerCloseTime});
			}
		}else if(flag == 'update'){
			
			//删除
			var rowIds = getSelectedRow('tongzhi_jqGrid');
			jQuery('#tongzhi_jqGrid').delRowData(rowIds[0]);
			//添加
			var data = getFormData('guandan_jqGrid_formBox');
			console.log(data);
			var currentNumber = uuid.v4();
			var result = jQuery('#tongzhi_jqGrid').addRowData(currentNumber,data,'first');
			
			if(result){
				layer.msg('更新成功',{time:layerCloseTime});
				layer.close(layerIndex);
				jQuery('#tongzhi_jqGrid').setSelection(currentNumber,true);
			}else{
				layer.msg('更新失败!',{time:layerCloseTime});
			}
		}
		
	});
	//左下角编辑按钮
	function updateLayer(){
		flag = 'update';
		var setting = {
			gridId : 'tongzhi_jqGrid',
			formBoxId : 'guandan_jqGrid_formBox',
			title : '修改模块',
			area : ['98%', '98%']
		};
		layerIndex = updateGridData(setting);
	}
	//打印按钮
	function tongzhi_addLayer(){
		var rowIds = getSelectedRow('yulu_jqGrid');
		if(rowIds && $.isArray(rowIds) && rowIds.length >= 1 ){
			layer.msg('打印成功!',{time:layerCloseTime});
		}else{
			layer.msg('请选择一条记录!',{time:layerCloseTime});
		}
	};
	$('#yulu_save_btn').on('click',function(){
		layer.msg('打印成功!',{time:layerCloseTime});
	});
	//格式化标题
	function formatName(cellValue, options, rowObject) {
		var len = cellValue.length;
		if(len>50){
			cellValue = cellValue.substring(0, 50) + "...";
		}
		return '<a href="javascript:;" onclick="lookInfo(\''+options.gid+'\',\''+options.rowId+'\')">'+cellValue+'</a>';
	};
	
	fetchGridData();

	//公共调用方法
	function Merger(gridName, CellName) {
        //得到显示到界面的id集合
        var mya = $("#" + gridName + "").getDataIDs();
        //当前显示多少条
        var length = mya.length;
        for (var i = 0; i < length; i++) {
            //从上到下获取一条信息
            var before = $("#" + gridName + "").jqGrid('getRowData', mya[i]);
            //定义合并行数
            var rowSpanTaxCount = 1;
            for (j = i + 1; j <= length; j++) {
                //和上边的信息对比 如果值一样就合并行数+1 然后设置rowspan 让当前单元格隐藏
                var end = $("#" + gridName + "").jqGrid('getRowData', mya[j]);
                if (before[CellName] == end[CellName]) {
                    rowSpanTaxCount++;
                    $("#" + gridName + "").setCell(mya[j], CellName, '', { display: 'none' });
                } else {
                    rowSpanTaxCount = 1;
                    break;
                }
            	$("#" + CellName + "" + mya[i] + "").attr("rowspan", rowSpanTaxCount);
            }
        }
    }
	//editGridRow新增记录；viewGridRow查看记录详情；delGridRow删除记录。
	
	
	
	//弹框取消按钮
	$('.qx').on('click',function(){
		layer.close(index);
	});

	//获取json数据
	function fetchGridData() {

		var gridArrayData = [];
		// show loading message
		$("#tongzhi_jqGrid")[0].grid.beginReq();
		$.ajax({
			url: dataUrl,
			success: function(result) {
				for (var i = 0; i < result.items.length; i++) {
					var item = result.items[i];
					
					gridArrayData.push({
						number: item.number,
						company: item.company,
						Tarate: item.Tarate,
						RefundRate: item.RefundRate,
						name: item.name,
						quantity: item.quantity,
						unit: item.unit,
						money: item.money,
						anotherNumber: item.anotherNumber,
						numbers: item.numbers,
						tongzhi: item.tongzhi
					});

				}
				// set the new data
				$("#tongzhi_jqGrid").jqGrid('setGridParam', {
					data: gridArrayData
				});
				// hide the show message
				$("#tongzhi_jqGrid")[0].grid.endReq();
				// refresh the grid
				$("#tongzhi_jqGrid").trigger('reloadGrid');
			}
		});
	}
	//格式化标题
	function formatTitle(cellValue, options, rowObject) {
		return cellValue.substring(0, 50) + "...";
	};
	//格式化链接
	function formatLink(cellValue, options, rowObject) {
		return "<a href='" + cellValue + "'>" + cellValue.substring(0, 25) + "..." + "</a>";
	};
	//获取选择的行
	function getSelectedRow() {
	    var grid = $("#tongzhi_jqGrid");
	    var rowKeys = grid.jqGrid('getGridParam',"selarrrow");

	   return rowKeys;
	}
	
	
	changeSearch(); //修改工具条
	
});
function lookInfo(gid,rowId){
	var data = $('#'+gid).getRowData(rowId);
	data.name = $(data.name).text();
	data.relName = $(data.relName).text();
	setFormData(gid+'_formBox',data);
	title = '查看信息';
	commIndex = layer.open({
		type: 1,
		title : title,
		area: ['98%', '98%'], //宽高
		content: $('#tongzhi_formBox')
	});
}

	
</script>



